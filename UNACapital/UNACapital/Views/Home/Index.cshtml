@model UNACapital.ViewModels.IndexVM

@{
    ViewBag.Title = "Index";
}
<div>
    <h2>Tabela CBLC</h2>

    <table class="table">
        <thead>
            <tr>
                <td>Data</td>
                <td>Número</td>
                <td>Quantidade de Ações</td>
                <td>Valor R$</td>
                <td>Doador</td>
                <td>Tomador</td>
                <td>Cotação Média</td>
                <td>Taxa média 3 dias</td>
                <td>Posição em Aberto</td>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>@Model.CBLC.Date.ToString("dd/MM/yyyy")</td>
                <td>@Model.CBLC.NumberContracts</td>
                <td>@Model.CBLC.AmountActions</td>
                <td>@Model.CBLC.Value</td>
                <td>@Model.CBLC.Donator</td>
                <td>@Model.CBLC.Taker</td>
                <td>@Model.CBLC.Cotation</td>
                <td>@Model.CBLC.ThreeDays</td>
                <td>@Model.CBLC.OpenPosition</td>
            </tr>
        </tbody>
    </table>
</div>

<br />
<br />

<h2 id="lblAction">Ação: @Model.Action</h2>
<br />

<div class="col-lg-12" style="padding: 0;">
    <div class="col-lg-4" style="padding: 0;">
        <label>Ação</label>
        <input type="text" id="txtAction" style="width: 100%;" />
    </div>
    <div class="col-lg-4" style="padding: 0;">
        <label>Data Inicial</label>
        <input type="text" id="txtStartDate" style="width: 100%;" />
    </div>
    <div class="col-lg-4" style="padding: 0;">
        <label>Data Final</label>
        <input type="text" id="txtEndDate" style="width: 100%;" />
    </div>
</div>

<br />
<br />

<div class="col-lg-12" style="padding: 0;">
    <input type="button" onclick="search();" value="Pesquisar" class="btn" />
</div>


<br />
<br />

<div id="chartContainer"></div>

<div id="container"></div>

<script type="text/javascript">

    function search(){
        var action = $("#txtAction").val();
        var startDate = $("#txtStartDate").val();
        var endDate = $("#txtEndDate").val();

        window.location.replace("/home/index?currAction=" + action + "&startDate=" + startDate + "&endDate=" + endDate + "");
    }

    $(function () {
        var chart = new CanvasJS.Chart("chartContainer", {
            theme: "theme2",
            zoomEnabled: true,
            animationEnabled: true,
            title: {
                text: "@Model.Action"
            },
            axisY: {
                prefix: "R$ "
            },
            toolTip: {
                shared: true,
                content: "<span><strong>{name}</strong></span> : <span>{x}</span> - <span>R${y}</span> "
            },
            data: [
            {
                type: "line",
                name: "CDI",
                showInLegend: true,
                dataPoints: [
                    @foreach (UNACapital.Models.CDI c in Model.CDIs)
                    {
                        <Text>{x: new Date(@c.Date.Year, (@c.Date.Month - 1), @c.Date.Day) , y: @c.Number},</Text>
                        }
                ],
            },
            {
                type: "line",
                name: "Cotação",
                showInLegend: true,
                dataPoints: [
                    @foreach (UNACapital.Models.Cotation co in Model.Cotations)
                    {
                        <Text>{x: new Date(@co.Date.Year, (@co.Date.Month - 1), @co.Date.Day) , y: (@co.Number)},</Text>
                    }
                ],

                //You can add dynamic data from the controller as shown below. Check the controller and uncomment the line which generates dataPoints.
                //dataPoints: @Html.Raw(ViewBag.DataPoints),
            }
            ]
        });
        chart.render();
    });
</script>
